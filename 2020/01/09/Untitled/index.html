<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="来自buu上的红帽杯的试题 easy re放入了ida进行分析，打开后shift+f12进行关键字的查找，找到了主函数 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747">
<meta property="og:type" content="article">
<meta property="og:title" content="红帽杯RE WP">
<meta property="og:url" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2020&#x2F;01&#x2F;09&#x2F;Untitled&#x2F;index.html">
<meta property="og:site_name" content="L0x1c-Grow Up">
<meta property="og:description" content="来自buu上的红帽杯的试题 easy re放入了ida进行分析，打开后shift+f12进行关键字的查找，找到了主函数 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747">
<meta property="og:locale" content="en">
<meta property="og:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;images&#x2F;pasted-144.png">
<meta property="og:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;images&#x2F;pasted-145.png">
<meta property="og:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;images&#x2F;pasted-146.png">
<meta property="og:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;images&#x2F;pasted-148.png">
<meta property="og:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;images&#x2F;pasted-149.png">
<meta property="og:updated_time" content="2020-01-10T08:19:58.501Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;images&#x2F;pasted-144.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2020/01/09/Untitled/"/>





  <title>红帽杯RE WP | L0x1c-Grow Up</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">L0x1c-Grow Up</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">默默学习二进制的一个小白</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="Searching..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/09/Untitled/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="L0x1c">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/header.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L0x1c-Grow Up">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">红帽杯RE WP</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-09T21:10:17+08:00">
                2020-01-09
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">Post modified&#58;</span>
              
              <time title="Post modified" itemprop="dateModified" datetime="2020-01-10T16:19:58+08:00">
                2020-01-10
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF-RE/" itemprop="url" rel="index">
                    <span itemprop="name">CTF-RE</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                <span title="Words count in article">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                <span title="Reading time">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>来自buu上的红帽杯的试题</p>
<h2 id="easy-re"><a href="#easy-re" class="headerlink" title="easy re"></a>easy re</h2><p>放入了ida进行分析，打开后shift+f12进行关键字的查找，找到了主函数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br></pre></td><td class="code"><pre><span class="line">signed __int64 sub_4009C6()</span><br><span class="line">&#123;</span><br><span class="line">  char *v0; // rsi</span><br><span class="line">  char *v1; // rdi</span><br><span class="line">  __int64 v2; // rax</span><br><span class="line">  signed __int64 result; // rax</span><br><span class="line">  unsigned __int64 v4; // rax</span><br><span class="line">  __int64 v5; // rax</span><br><span class="line">  const __m128i *v6; // ST10_8</span><br><span class="line">  const __m128i *v7; // ST18_8</span><br><span class="line">  const __m128i *v8; // ST20_8</span><br><span class="line">  const __m128i *v9; // ST28_8</span><br><span class="line">  const __m128i *v10; // ST30_8</span><br><span class="line">  const __m128i *v11; // ST38_8</span><br><span class="line">  const __m128i *v12; // ST40_8</span><br><span class="line">  const __m128i *v13; // ST48_8</span><br><span class="line">  const __m128i *v14; // ST50_8</span><br><span class="line">  __int64 v15; // ST58_8</span><br><span class="line">  int i; // [rsp+Ch] [rbp-114h]</span><br><span class="line">  char v17; // [rsp+60h] [rbp-C0h]</span><br><span class="line">  char v18; // [rsp+61h] [rbp-BFh]</span><br><span class="line">  char v19; // [rsp+62h] [rbp-BEh]</span><br><span class="line">  char v20; // [rsp+63h] [rbp-BDh]</span><br><span class="line">  char v21; // [rsp+64h] [rbp-BCh]</span><br><span class="line">  char v22; // [rsp+65h] [rbp-BBh]</span><br><span class="line">  char v23; // [rsp+66h] [rbp-BAh]</span><br><span class="line">  char v24; // [rsp+67h] [rbp-B9h]</span><br><span class="line">  char v25; // [rsp+68h] [rbp-B8h]</span><br><span class="line">  char v26; // [rsp+69h] [rbp-B7h]</span><br><span class="line">  char v27; // [rsp+6Ah] [rbp-B6h]</span><br><span class="line">  char v28; // [rsp+6Bh] [rbp-B5h]</span><br><span class="line">  char v29; // [rsp+6Ch] [rbp-B4h]</span><br><span class="line">  char v30; // [rsp+6Dh] [rbp-B3h]</span><br><span class="line">  char v31; // [rsp+6Eh] [rbp-B2h]</span><br><span class="line">  char v32; // [rsp+6Fh] [rbp-B1h]</span><br><span class="line">  char v33; // [rsp+70h] [rbp-B0h]</span><br><span class="line">  char v34; // [rsp+71h] [rbp-AFh]</span><br><span class="line">  char v35; // [rsp+72h] [rbp-AEh]</span><br><span class="line">  char v36; // [rsp+73h] [rbp-ADh]</span><br><span class="line">  char v37; // [rsp+74h] [rbp-ACh]</span><br><span class="line">  char v38; // [rsp+75h] [rbp-ABh]</span><br><span class="line">  char v39; // [rsp+76h] [rbp-AAh]</span><br><span class="line">  char v40; // [rsp+77h] [rbp-A9h]</span><br><span class="line">  char v41; // [rsp+78h] [rbp-A8h]</span><br><span class="line">  char v42; // [rsp+79h] [rbp-A7h]</span><br><span class="line">  char v43; // [rsp+7Ah] [rbp-A6h]</span><br><span class="line">  char v44; // [rsp+7Bh] [rbp-A5h]</span><br><span class="line">  char v45; // [rsp+7Ch] [rbp-A4h]</span><br><span class="line">  char v46; // [rsp+7Dh] [rbp-A3h]</span><br><span class="line">  char v47; // [rsp+7Eh] [rbp-A2h]</span><br><span class="line">  char v48; // [rsp+7Fh] [rbp-A1h]</span><br><span class="line">  char v49; // [rsp+80h] [rbp-A0h]</span><br><span class="line">  char v50; // [rsp+81h] [rbp-9Fh]</span><br><span class="line">  char v51; // [rsp+82h] [rbp-9Eh]</span><br><span class="line">  char v52; // [rsp+83h] [rbp-9Dh]</span><br><span class="line">  char v53[32]; // [rsp+90h] [rbp-90h]</span><br><span class="line">  int v54; // [rsp+B0h] [rbp-70h]</span><br><span class="line">  char v55; // [rsp+B4h] [rbp-6Ch]</span><br><span class="line">  char v56; // [rsp+C0h] [rbp-60h]</span><br><span class="line">  char v57; // [rsp+E7h] [rbp-39h]</span><br><span class="line">  char v58; // [rsp+100h] [rbp-20h]</span><br><span class="line">  unsigned __int64 v59; // [rsp+108h] [rbp-18h]</span><br><span class="line"></span><br><span class="line">  v59 = __readfsqword(40u);</span><br><span class="line">  v17 = <span class="string">'I'</span>;</span><br><span class="line">  v18 = <span class="string">'o'</span>;</span><br><span class="line">  v19 = <span class="string">'d'</span>;</span><br><span class="line">  v20 = <span class="string">'l'</span>;</span><br><span class="line">  v21 = <span class="string">'&gt;'</span>;</span><br><span class="line">  v22 = <span class="string">'Q'</span>;</span><br><span class="line">  v23 = <span class="string">'n'</span>;</span><br><span class="line">  v24 = <span class="string">'b'</span>;</span><br><span class="line">  v25 = <span class="string">'('</span>;</span><br><span class="line">  v26 = <span class="string">'o'</span>;</span><br><span class="line">  v27 = <span class="string">'c'</span>;</span><br><span class="line">  v28 = <span class="string">'y'</span>;</span><br><span class="line">  v29 = <span class="string">''</span>;</span><br><span class="line">  v30 = <span class="string">'y'</span>;</span><br><span class="line">  v31 = <span class="string">'.'</span>;</span><br><span class="line">  v32 = <span class="string">'i'</span>;</span><br><span class="line">  v33 = <span class="string">''</span>;</span><br><span class="line">  v34 = <span class="string">'d'</span>;</span><br><span class="line">  v35 = <span class="string">'`'</span>;</span><br><span class="line">  v36 = <span class="string">'3'</span>;</span><br><span class="line">  v37 = <span class="string">'w'</span>;</span><br><span class="line">  v38 = <span class="string">'&#125;'</span>;</span><br><span class="line">  v39 = <span class="string">'w'</span>;</span><br><span class="line">  v40 = <span class="string">'e'</span>;</span><br><span class="line">  v41 = <span class="string">'k'</span>;</span><br><span class="line">  v42 = <span class="string">'9'</span>;</span><br><span class="line">  v43 = <span class="string">'&#123;'</span>;</span><br><span class="line">  v44 = <span class="string">'i'</span>;</span><br><span class="line">  v45 = <span class="string">'y'</span>;</span><br><span class="line">  v46 = <span class="string">'='</span>;</span><br><span class="line">  v47 = <span class="string">'~'</span>;</span><br><span class="line">  v48 = <span class="string">'y'</span>;</span><br><span class="line">  v49 = <span class="string">'L'</span>;</span><br><span class="line">  v50 = <span class="string">'@'</span>;</span><br><span class="line">  v51 = <span class="string">'E'</span>;</span><br><span class="line">  v52 = <span class="string">'C'</span>;</span><br><span class="line">  memset(v53, 0, sizeof(v53));</span><br><span class="line">  v54 = 0;</span><br><span class="line">  v55 = 0;</span><br><span class="line">  v0 = v53;</span><br><span class="line">  sub_4406E0(0LL, (__int64)v53);</span><br><span class="line">  v55 = 0;</span><br><span class="line">  v1 = v53;</span><br><span class="line">  LODWORD(v2) = sub_424BA0((const __m128i *)v53);</span><br><span class="line">  <span class="keyword">if</span> ( v2 == 36 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = 0; ; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      v1 = v53;</span><br><span class="line">      LODWORD(v4) = sub_424BA0((const __m128i *)v53);</span><br><span class="line">      <span class="keyword">if</span> ( i &gt;= v4 )</span><br><span class="line">        <span class="built_in">break</span>;</span><br><span class="line">      <span class="keyword">if</span> ( (unsigned __int8)(v53[i] ^ i) != *(&amp;v17 + i) )</span><br><span class="line">      &#123;</span><br><span class="line">        result = 4294967294LL;</span><br><span class="line">        goto LABEL_13;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    sub_410CC0((const __m128i *)<span class="string">"continue!"</span>);</span><br><span class="line">    memset(&amp;v56, 0, 0x40uLL);</span><br><span class="line">    v58 = 0;</span><br><span class="line">    v0 = &amp;v56;</span><br><span class="line">    sub_4406E0(0LL, (__int64)&amp;v56);</span><br><span class="line">    v57 = 0;</span><br><span class="line">    v1 = &amp;v56;</span><br><span class="line">    LODWORD(v5) = sub_424BA0((const __m128i *)&amp;v56);</span><br><span class="line">    <span class="keyword">if</span> ( v5 == 39 )</span><br><span class="line">    &#123;</span><br><span class="line">      v6 = (const __m128i *)sub_400E44((const __m128i *)&amp;v56);</span><br><span class="line">      v7 = (const __m128i *)sub_400E44(v6);</span><br><span class="line">      v8 = (const __m128i *)sub_400E44(v7);</span><br><span class="line">      v9 = (const __m128i *)sub_400E44(v8);</span><br><span class="line">      v10 = (const __m128i *)sub_400E44(v9);</span><br><span class="line">      v11 = (const __m128i *)sub_400E44(v10);</span><br><span class="line">      v12 = (const __m128i *)sub_400E44(v11);</span><br><span class="line">      v13 = (const __m128i *)sub_400E44(v12);</span><br><span class="line">      v14 = (const __m128i *)sub_400E44(v13);</span><br><span class="line">      v15 = sub_400E44(v14);</span><br><span class="line">      v0 = off_6CC090;</span><br><span class="line">      v1 = (char *)v15;</span><br><span class="line">      <span class="keyword">if</span> ( !(unsigned int)sub_400360(v15, (__int64)off_6CC090) )</span><br><span class="line">      &#123;</span><br><span class="line">        sub_410CC0((const __m128i *)<span class="string">"You found me!!!"</span>);</span><br><span class="line">        v1 = <span class="string">"bye bye~"</span>;</span><br><span class="line">        sub_410CC0((const __m128i *)<span class="string">"bye bye~"</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      result = 0LL;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      result = 4294967293LL;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    result = 0xFFFFFFFFLL;</span><br><span class="line">  &#125;</span><br><span class="line">LABEL_13:</span><br><span class="line">  <span class="keyword">if</span> ( __readfsqword(0x28u) != v59 )</span><br><span class="line">    sub_444020(v1, v0);</span><br><span class="line">  <span class="built_in">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看到第一次的异或</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( v2 == 36 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = 0; ; ++i )</span><br><span class="line">    &#123;</span><br><span class="line">      v1 = v53;</span><br><span class="line">      LODWORD(v4) = sub_424BA0((const __m128i *)v53);</span><br><span class="line">      <span class="keyword">if</span> ( i &gt;= v4 )</span><br><span class="line">        <span class="built_in">break</span>;</span><br><span class="line">      <span class="keyword">if</span> ( (unsigned __int8)(v53[i] ^ i) != *(&amp;v17 + i) )</span><br><span class="line">      &#123;</span><br><span class="line">        result = 4294967294LL;</span><br><span class="line">        goto LABEL_13;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>一共和36个字符进行比较，跟输入的v17的进行比较，需要输入的v53[i]^i等于上面有的v17到v52可以写出脚本</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include&lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include&lt;string&gt;</span></span><br><span class="line"><span class="comment">#include&lt;iostream&gt;</span></span><br><span class="line">using namespace std;</span><br><span class="line">int <span class="function"><span class="title">main</span></span>() &#123;</span><br><span class="line">	string A = <span class="string">"Iodl&gt;Qnb(ocy y.i d`3w&#125;wek9&#123;iy=~yL@EC"</span>;</span><br><span class="line">	<span class="keyword">for</span> (int i = 0;A[i];i++) &#123;</span><br><span class="line">		A[i] = A[i] ^ i;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; A &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line">//Info:The first four chars are `flag`</span><br></pre></td></tr></table></figure>
<p>得出来Info:The first four chars are `flag`得出来了一个信息，然后继续向下看</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">memset(&amp;v56, 0,64uLL);</span><br><span class="line">v58 = 0;</span><br><span class="line">v0 = &amp;v56;</span><br><span class="line">sub_4406E0(0LL, (__int64)&amp;v56);</span><br><span class="line">v57 = 0;</span><br><span class="line">v1 = &amp;v56;</span><br><span class="line">LODWORD(v5) = sub_424BA0((const __m128i *)&amp;v56);</span><br><span class="line"><span class="keyword">if</span> ( v5 == 39 )</span><br><span class="line">&#123;</span><br><span class="line">  v6 = (const __m128i *)sub_400E44((const __m128i *)&amp;v56);</span><br><span class="line">  v7 = (const __m128i *)sub_400E44(v6);</span><br><span class="line">  v8 = (const __m128i *)sub_400E44(v7);</span><br><span class="line">  v9 = (const __m128i *)sub_400E44(v8);</span><br><span class="line">  v10 = (const __m128i *)sub_400E44(v9);</span><br><span class="line">  v11 = (const __m128i *)sub_400E44(v10);</span><br><span class="line">  v12 = (const __m128i *)sub_400E44(v11);</span><br><span class="line">  v13 = (const __m128i *)sub_400E44(v12);</span><br><span class="line">  v14 = (const __m128i *)sub_400E44(v13);</span><br><span class="line">  v15 = sub_400E44(v14);</span><br><span class="line">  v0 = off_6CC090;</span><br><span class="line">  v1 = (char *)v15;</span><br><span class="line">  <span class="keyword">if</span> ( !(unsigned int)sub_400360(v15, (__int64)off_6CC090) )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_410CC0((const __m128i *)<span class="string">"You found me!!!"</span>);</span><br><span class="line">    v1 = <span class="string">"bye bye~"</span>;</span><br><span class="line">    sub_410CC0((const __m128i *)<span class="string">"bye bye~"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  result = 0LL;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">.rodata:00000000004A23A8 aVm0wd2vhuxhtwg db <span class="string">'Vm0wd2VHUXhTWGhpUm1SWVYwZDRWVll3Wkc5WFJsbDNXa1pPVlUxV2NIcFhhMk0xV'</span></span><br><span class="line">.rodata:00000000004A23A8                                         ; DATA XREF: .data:off_6CC090↓o</span><br><span class="line">.rodata:00000000004A23A8                 db <span class="string">'mpKS1NHVkdXbFpOYmtKVVZtcEtTMUl5VGtsaVJtUk9ZV3hhZVZadGVHdFRNVTVYVW'</span></span><br><span class="line">.rodata:00000000004A23A8                 db <span class="string">'01T2FGSnRVbGhhVjNoaFZWWmtWMXBFVWxSTmJFcElWbTAxVDJGV1NuTlhia0pXWWx'</span></span><br><span class="line">.rodata:00000000004A23A8                 db <span class="string">'ob1dGUnJXbXRXTVZaeVdrWm9hVlpyV1hwV1IzaGhXVmRHVjFOdVVsWmlhMHBZV1ZS'</span></span><br><span class="line">.rodata:00000000004A23A8                 db <span class="string">'R1lWZEdVbFZTYlhSWFRWWndNRlZ0TVc5VWJGcFZWbXR3VjJKSFVYZFdha1pXWlZaT'</span></span><br><span class="line">.rodata:00000000004A23A8                 db <span class="string">'2NtRkhhRk5pVjJoWVYxZDBhMVV3TlhOalJscFlZbGhTY1ZsclduZGxiR1J5VmxSR1'</span></span><br><span class="line">.rodata:00000000004A23A8                 db <span class="string">'ZXSlZjRWhaTUZKaFZqSktWVkZZYUZkV1JWcFlWV3BHYTFkWFRrZFRiV3hvVFVoQ1d'</span></span><br><span class="line">.rodata:00000000004A23A8                 db <span class="string">'sWXhaRFJpTWtsM1RVaG9hbEpYYUhOVmJUVkRZekZhY1ZKcmRGTk5Wa3A2VjJ0U1Ex'</span></span><br><span class="line">.rodata:00000000004A23A8                 db <span class="string">'WlhTbFpqUldoYVRVWndkbFpxUmtwbGJVWklZVVprYUdFeGNHOVhXSEJIWkRGS2RGS'</span></span><br><span class="line">.rodata:00000000004A23A8                 db <span class="string">'nJhR2hTYXpWdlZGVm9RMlJzV25STldHUlZUVlpXTlZadE5VOVdiVXBJVld4c1dtSl'</span></span><br><span class="line">.rodata:00000000004A23A8                 db <span class="string">'lUWGhXTUZwell6RmFkRkpzVWxOaVNFSktWa1phVTFFeFduUlRhMlJxVWxad1YxWnR'</span></span><br><span class="line">.rodata:00000000004A23A8                 db <span class="string">'lRXRXTVZaSFVsUnNVVlZVTURrPQ=='</span>,0</span><br></pre></td></tr></table></figure>
<p>不难看出是经过了10次的base64，变成了如下的密文，所以本人直接在网上解密了10次，emmm，之后会写个分析base64和解密base64的exp的<br><img src="/images/pasted-144.png" alt="upload successful"><br>得出来是一个看雪的网址：<a href="https://bbs.pediy.com/thread-254172.htm" target="_blank" rel="noopener">https://bbs.pediy.com/thread-254172.htm</a><br><img src="/images/pasted-145.png" alt="upload successful"><br>shift+f7发现在.fini还存在一个函数，里面存放的是程序运行main函数之后所运行的函数，而.init是在main函数之前的</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">unsigned __int64 sub_400D35()</span><br><span class="line">&#123;</span><br><span class="line">  __int64 v0; // rdi</span><br><span class="line">  unsigned __int64 result; // rax</span><br><span class="line">  unsigned __int64 v2; // rt1</span><br><span class="line">  unsigned int v3; // [rsp+Ch] [rbp-24h]</span><br><span class="line">  signed int i; // [rsp+10h] [rbp-20h]</span><br><span class="line">  signed int j; // [rsp+14h] [rbp-1Ch]</span><br><span class="line">  unsigned int v6; // [rsp+24h] [rbp-Ch]</span><br><span class="line">  unsigned __int64 v7; // [rsp+28h] [rbp-8h]</span><br><span class="line"></span><br><span class="line">  v7 = __readfsqword(0x28u);</span><br><span class="line">  v0 = 0LL;</span><br><span class="line">  v3 = sub_43FD20() - qword_6CEE38;</span><br><span class="line">  <span class="keyword">for</span> ( i = 0; i &lt;= 1233; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v0 = v3;</span><br><span class="line">    sub_40F790(v3);</span><br><span class="line">    sub_40FE60(v3);</span><br><span class="line">    sub_40FE60(v3);</span><br><span class="line">    v3 = (unsigned __int64)sub_40FE60(v3) ^ 0x98765432;</span><br><span class="line">  &#125;</span><br><span class="line">  v6 = v3;</span><br><span class="line">  <span class="keyword">if</span> ( ((unsigned __int8)v3 ^ byte_6CC0A0[0]) == 102 &amp;&amp; (HIBYTE(v6) ^ (unsigned __int8)byte_6CC0A3) == 103 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( j = 0; j &lt;= 24; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      v0 = (unsigned __int8)(byte_6CC0A0[j] ^ *((_BYTE *)&amp;v6 + j % 4));</span><br><span class="line">      sub_410E90(v0);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  v2 = __readfsqword(0x28u);</span><br><span class="line">  result = v2 ^ v7;</span><br><span class="line">  <span class="keyword">if</span> ( v2 != v7 )</span><br><span class="line">    sub_444020(v0);</span><br><span class="line">  <span class="built_in">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>进行分析，一共是两次异或，可以看出来v6=v3且102为f 103为g推断为上面的提示字符串flag 和内存中给的数据反向解密</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include&lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include&lt;string&gt;</span></span><br><span class="line"><span class="comment">#include&lt;iostream&gt;</span></span><br><span class="line">using namespace std;</span><br><span class="line">int <span class="function"><span class="title">main</span></span>() &#123;</span><br><span class="line">	char key3[4] = &#123;&#125;;</span><br><span class="line">	string key1 = <span class="string">"flag"</span>;</span><br><span class="line">	char key2[] =  &#123;</span><br><span class="line">    0x40,0x35,0x20,0x56,0x5D,0x18,0x22,0x45,0x17,0x2F,0x24,0x6E,0x62,0x3C,0x27,0x54,0x48,0x6C,0x24,0x6E,0x72,0x3C,0x32,0x45,0x5B &#125;;</span><br><span class="line">	<span class="keyword">for</span> (int i = 0;i &lt; 4;i++) &#123;</span><br><span class="line">		key3[i] = key1[i] ^ key2[i];</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; key3 &lt;&lt; endl;//&amp;YA1</span><br><span class="line">	char flag[40] = &#123;&#125;;</span><br><span class="line">	<span class="keyword">for</span> (int i = 0;i &lt; 25;i++) &#123;</span><br><span class="line">		flag[i] = key2[i] ^ key3[i % 4];</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; flag &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line">//flag&#123;Act1ve_Defen5e_Test&#125;</span><br></pre></td></tr></table></figure>
<h2 id="xx"><a href="#xx" class="headerlink" title="xx"></a>xx</h2><p>打开ida，shift+12找到了主函数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br></pre></td><td class="code"><pre><span class="line">int __fastcall sub_1400011A0(__int64 a1, __int64 a2)</span><br><span class="line">&#123;</span><br><span class="line">  signed __int64 v2; // rbx@1</span><br><span class="line">  signed __int64 v3; // rax@1</span><br><span class="line">  __int64 v4; // rax@6</span><br><span class="line">  __int64 v5; // r11@6</span><br><span class="line">  __int128 *v6; // r14@6</span><br><span class="line">  int v7; // edi@6</span><br><span class="line">  _BYTE *v8; // rsi@6</span><br><span class="line">  char v9; // r10@7</span><br><span class="line">  int v10; // edx@7</span><br><span class="line">  __int64 v11; // r8@7</span><br><span class="line">  unsigned __int64 v12; // rcx@7</span><br><span class="line">  signed __int64 v13; // rcx@12</span><br><span class="line">  unsigned __int64 v14; // rax@18</span><br><span class="line">  unsigned __int64 i; // rax@28</span><br><span class="line">  __int64 v16; // rax@30</span><br><span class="line">  size_t v17; // rsi@30</span><br><span class="line">  __int64 v18; // rbx@30</span><br><span class="line">  __int64 v19; // r9@30</span><br><span class="line">  signed int v20; // er11@30</span><br><span class="line">  char *v21; // r8@30</span><br><span class="line">  signed __int64 v22; // rcx@31</span><br><span class="line">  char v23; // al@32</span><br><span class="line">  __int64 v24; // r9@35</span><br><span class="line">  signed __int64 v25; // rdx@35</span><br><span class="line">  __int64 v26; // rax@38</span><br><span class="line">  __int64 v28; // [sp+0h] [bp-68h]@38</span><br><span class="line">  size_t Size; // [sp+20h] [bp-48h]@30</span><br><span class="line">  __int128 v30; // [sp+28h] [bp-40h]@18</span><br><span class="line">  int v31; // [sp+38h] [bp-30h]@35</span><br><span class="line">  int v32; // [sp+3Ch] [bp-2Ch]@35</span><br><span class="line">  int Code[4]; // [sp+40h] [bp-28h]@1</span><br><span class="line">  int v34; // [sp+50h] [bp-18h]@1</span><br><span class="line">  __int64 v35; // [sp+58h] [bp-10h]@38</span><br><span class="line"></span><br><span class="line">  *(_OWORD *)Code = 0i64;</span><br><span class="line">  v34 = 0;</span><br><span class="line">  sub_1400018C0(std::cin, a2, Code);</span><br><span class="line">  v2 = -1i64;</span><br><span class="line">  v3 = -1i64;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    ++v3;</span><br><span class="line">  <span class="keyword">while</span> ( *((_BYTE *)Code + v3) );</span><br><span class="line">  <span class="keyword">if</span> ( v3 != 19 )  	 //判断输入的字符串的长度为19</span><br><span class="line">  &#123;</span><br><span class="line">    sub_140001620(std::cout, <span class="string">"error\n"</span>);</span><br><span class="line">    _exit((unsigned __int64)Code);</span><br><span class="line">  &#125;</span><br><span class="line">  v4 = sub_140001E5C(5ui64);</span><br><span class="line">  v5 = *(_QWORD *)&amp;::Code;   //qwertyuiopasdfghjklzxcvbnm1234567890的首地址</span><br><span class="line">  v6 = (__int128 *)v4;</span><br><span class="line">  v7 = 0;</span><br><span class="line">  v8 = (_BYTE *)v4;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    v9 = v8[(_QWORD)Code - v4];</span><br><span class="line">    v10 = 0;</span><br><span class="line">    *v8 = v9;</span><br><span class="line">    v11 = 0i64;</span><br><span class="line">    v12 = -1i64;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">      ++v12;</span><br><span class="line">    <span class="keyword">while</span> ( *(_BYTE *)(v5 + v12) );</span><br><span class="line">    <span class="keyword">if</span> ( v12 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v9 == *(_BYTE *)(v5 + v11) )</span><br><span class="line">          <span class="built_in">break</span>;</span><br><span class="line">        ++v10;</span><br><span class="line">        ++v11;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( v10 &lt; v12 );</span><br><span class="line">    &#125;</span><br><span class="line">    v13 = -1i64;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">      ++v13;</span><br><span class="line">    <span class="keyword">while</span> ( *(_BYTE *)(v5 + v13) );</span><br><span class="line">    <span class="keyword">if</span> ( v10 == v13 )</span><br><span class="line">      _exit(v5);</span><br><span class="line">    ++v8;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( (signed __int64)&amp;v8[-v4] &lt; 4 );</span><br><span class="line">  *(_BYTE *)(v4 + 4) = 0;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    ++v2;</span><br><span class="line">  <span class="keyword">while</span> ( *((_BYTE *)Code + v2) );</span><br><span class="line">  v14 = 0i64;</span><br><span class="line">  v30 = *v6;</span><br><span class="line">  <span class="keyword">while</span> ( *((_BYTE *)&amp;v30 + v14) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( !*((_BYTE *)&amp;v30 + v14 + 1) )</span><br><span class="line">    &#123;</span><br><span class="line">      ++v14;</span><br><span class="line">      <span class="built_in">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( !*((_BYTE *)&amp;v30 + v14 + 2) )</span><br><span class="line">    &#123;</span><br><span class="line">      v14 += 2i64;</span><br><span class="line">      <span class="built_in">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( !*((_BYTE *)&amp;v30 + v14 + 3) )</span><br><span class="line">    &#123;</span><br><span class="line">      v14 += 3i64;</span><br><span class="line">      <span class="built_in">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    v14 += 4i64;</span><br><span class="line">    <span class="keyword">if</span> ( v14 &gt;= 0x10 )</span><br><span class="line">      <span class="built_in">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( i = v14 + 1; i &lt; 0x10; ++i )</span><br><span class="line">    *((_BYTE *)&amp;v30 + i) = 0;</span><br><span class="line">  LODWORD(v16) = sub_140001AB0(Code, v2, &amp;v30, &amp;Size);</span><br><span class="line">  v17 = Size;</span><br><span class="line">  v18 = v16;</span><br><span class="line">  v19 = sub_140001E5C(Size);</span><br><span class="line">  v20 = 1;</span><br><span class="line">  *(_BYTE *)v19 = *(_BYTE *)(v18 + 2);</span><br><span class="line">  v21 = (char *)(v19 + 1);</span><br><span class="line">  *(_BYTE *)(v19 + 1) = *(_BYTE *)v18;</span><br><span class="line">  *(_BYTE *)(v19 + 2) = *(_BYTE *)(v18 + 3);</span><br><span class="line">  *(_BYTE *)(v19 + 3) = *(_BYTE *)(v18 + 1);</span><br><span class="line">  *(_BYTE *)(v19 + 4) = *(_BYTE *)(v18 + 6);</span><br><span class="line">  *(_BYTE *)(v19 + 5) = *(_BYTE *)(v18 + 4);</span><br><span class="line">  *(_BYTE *)(v19 + 6) = *(_BYTE *)(v18 + 7);</span><br><span class="line">  *(_BYTE *)(v19 + 7) = *(_BYTE *)(v18 + 5);</span><br><span class="line">  *(_BYTE *)(v19 + 8) = *(_BYTE *)(v18 + 10);</span><br><span class="line">  *(_BYTE *)(v19 + 9) = *(_BYTE *)(v18 + 8);</span><br><span class="line">  *(_BYTE *)(v19 + 10) = *(_BYTE *)(v18 + 11);</span><br><span class="line">  *(_BYTE *)(v19 + 11) = *(_BYTE *)(v18 + 9);</span><br><span class="line">  *(_BYTE *)(v19 + 12) = *(_BYTE *)(v18 + 14);</span><br><span class="line">  *(_BYTE *)(v19 + 13) = *(_BYTE *)(v18 + 12);</span><br><span class="line">  *(_BYTE *)(v19 + 14) = *(_BYTE *)(v18 + 15);</span><br><span class="line">  *(_BYTE *)(v19 + 15) = *(_BYTE *)(v18 + 13);</span><br><span class="line">  *(_BYTE *)(v19 + 16) = *(_BYTE *)(v18 + 18);</span><br><span class="line">  *(_BYTE *)(v19 + 17) = *(_BYTE *)(v18 + 16);</span><br><span class="line">  *(_BYTE *)(v19 + 18) = *(_BYTE *)(v18 + 19);</span><br><span class="line">  *(_BYTE *)(v19 + 19) = *(_BYTE *)(v18 + 17);</span><br><span class="line">  *(_BYTE *)(v19 + 20) = *(_BYTE *)(v18 + 22);</span><br><span class="line">  *(_BYTE *)(v19 + 21) = *(_BYTE *)(v18 + 20);</span><br><span class="line">  *(_BYTE *)(v19 + 22) = *(_BYTE *)(v18 + 23);</span><br><span class="line">  <span class="keyword">for</span> ( *(_BYTE *)(v19 + 23) = *(_BYTE *)(v18 + 21); v20 &lt; v17; ++v21 )</span><br><span class="line">  &#123;</span><br><span class="line">    v22 = 0i64;</span><br><span class="line">    <span class="keyword">if</span> ( v20 / 3 &gt; 0 )</span><br><span class="line">    &#123;</span><br><span class="line">      v23 = *v21;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        v23 ^= *(_BYTE *)(v22++ + v19);</span><br><span class="line">        *v21 = v23;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( v22 &lt; v20 / 3 );</span><br><span class="line">    &#125;</span><br><span class="line">    ++v20;</span><br><span class="line">  &#125;</span><br><span class="line">  *(_QWORD *)&amp;v30 = -4569681940847739698i64;</span><br><span class="line">  v24 = v19 - (_QWORD)&amp;v30;</span><br><span class="line">  *((_QWORD *)&amp;v30 + 1) = 3819887636644928495i64;</span><br><span class="line">  v25 = 0i64;</span><br><span class="line">  v31 = -939386845;</span><br><span class="line">  v32 = -95004953;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( *((_BYTE *)&amp;v30 + v25) != *((_BYTE *)&amp;v30 + v25 + v24) )</span><br><span class="line">      _exit(v7 * v7);</span><br><span class="line">    ++v7;</span><br><span class="line">    ++v25;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v25 &lt; 24 );</span><br><span class="line">  LODWORD(v26) = sub_140001620(std::cout, <span class="string">"You win!"</span>);</span><br><span class="line">  std::basic_ostream&lt;char,std::char_traits&lt;char&gt;&gt;::operator&lt;&lt;(v26, sub_1400017F0);</span><br><span class="line">  <span class="built_in">return</span> sub_140001E30((unsigned __int64)&amp;v28 ^ v35);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>刚开始判断了字符串的长度为19<br><img src="/images/pasted-146.png" alt="upload successful"><br>v5为qwertyuiopasdfghjklzxcvbnm1234567890的首地址，这里猜测v9为密钥一共是4位的和code有关，v12为v5字符串的长度36，v10为v9在v5中的位置相当于个数组，v13等于36，v4与v8与v9的密钥有关系，在v4的末尾加了\0，进行了一个取字符的一个循环,可以看到这个Golden ratio知道是TEA算法的分支<br><img src="/images/pasted-148.png" alt="upload successful"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br></pre></td><td class="code"><pre><span class="line">_BYTE *__fastcall sub_140001AB0(__int64 a1, unsigned __int64 a2, unsigned __int8 *a3, unsigned __int64 *a4)</span><br><span class="line">&#123;</span><br><span class="line">  unsigned __int64 *v4; // r13</span><br><span class="line">  unsigned __int8 *v5; // rbp</span><br><span class="line">  unsigned __int64 v6; // rbx</span><br><span class="line">  __int64 v7; // rsi</span><br><span class="line">  unsigned __int64 v8; // rdi</span><br><span class="line">  size_t v9; // rcx</span><br><span class="line">  _DWORD *v10; // rax</span><br><span class="line">  _DWORD *v11; // r15</span><br><span class="line">  signed __int64 v12; // r14</span><br><span class="line">  unsigned __int64 v13; // rdi</span><br><span class="line">  unsigned __int64 v14; // r9</span><br><span class="line">  int v15; // edx</span><br><span class="line">  _DWORD *v16; // r8</span><br><span class="line">  char v17; // cl</span><br><span class="line">  _DWORD *v18; // r12</span><br><span class="line">  int v19; // ecx</span><br><span class="line">  int v20; // eax</span><br><span class="line">  int v21; // ecx</span><br><span class="line">  int v22; // eax</span><br><span class="line">  int v23; // ecx</span><br><span class="line">  int v24; // eax</span><br><span class="line">  int v25; // ecx</span><br><span class="line">  int v26; // eax</span><br><span class="line">  unsigned int v27; // ebp</span><br><span class="line">  __int64 v28; // rcx</span><br><span class="line">  unsigned int v29; // er10</span><br><span class="line">  unsigned int v30; // eax</span><br><span class="line">  __int64 v31; // r9</span><br><span class="line">  unsigned int *v32; // rbx</span><br><span class="line">  __int64 v33; // r11</span><br><span class="line">  _DWORD *v34; // rax</span><br><span class="line">  __int64 v35; // rsi</span><br><span class="line">  __int64 v36; // r14</span><br><span class="line">  char v37; // r13</span><br><span class="line">  unsigned int v38; // er8</span><br><span class="line">  __int64 v39; // rcx</span><br><span class="line">  unsigned __int64 v40; // rbx</span><br><span class="line">  size_t v41; // rcx</span><br><span class="line">  _BYTE *v42; // rax</span><br><span class="line">  _BYTE *v43; // rsi</span><br><span class="line">  _BYTE *result; // rax</span><br><span class="line">  char v45; // [rsp+20h] [rbp-58h]</span><br><span class="line">  __int64 v46; // [rsp+28h] [rbp-50h]</span><br><span class="line">  signed __int64 v47; // [rsp+30h] [rbp-48h]</span><br><span class="line">  int v48; // [rsp+88h] [rbp+10h]</span><br><span class="line">  unsigned __int64 *v49; // [rsp+98h] [rbp+20h]</span><br><span class="line"></span><br><span class="line">  v49 = a4;</span><br><span class="line">  v4 = a4;</span><br><span class="line">  v5 = a3;</span><br><span class="line">  v6 = a2;</span><br><span class="line">  v7 = a1;</span><br><span class="line">  <span class="keyword">if</span> ( !a2 )</span><br><span class="line">    <span class="built_in">return</span> 0i64;</span><br><span class="line">  v8 = a2 &gt;&gt; 2;</span><br><span class="line">  <span class="keyword">if</span> ( a2 &amp; 3 )</span><br><span class="line">    v8 = (a2 &gt;&gt; 2) + 1;</span><br><span class="line">  v9 = v8 + 1;</span><br><span class="line">  <span class="keyword">if</span> ( v8 &gt;= 0xFFFFFFFFFFFFFFFFui64 )</span><br><span class="line">    v9 = -1i64;</span><br><span class="line">  v10 = calloc(v9, 4ui64);</span><br><span class="line">  v11 = v10;</span><br><span class="line">  <span class="keyword">if</span> ( !v10 )</span><br><span class="line">    <span class="built_in">return</span> 0i64;</span><br><span class="line">  v12 = v8 + 1;</span><br><span class="line">  v10[v8] = v6;</span><br><span class="line">  v13 = 0i64;</span><br><span class="line">  v47 = v12;</span><br><span class="line">  v14 = 0i64;</span><br><span class="line">  <span class="keyword">if</span> ( v6 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v15 = *(unsigned __int8 *)(v14 + v7);</span><br><span class="line">      v16 = &amp;v10[v14 &gt;&gt; 2];</span><br><span class="line">      v17 = v14++ &amp; 3;</span><br><span class="line">      *v16 |= v15 &lt;&lt; 8 * v17;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v14 &lt; v6 );</span><br><span class="line">  &#125;</span><br><span class="line">  v18 = calloc(4ui64, 4ui64);</span><br><span class="line">  <span class="keyword">if</span> ( v18 )</span><br><span class="line">  &#123;</span><br><span class="line">    v19 = v5[7] &lt;&lt; 8;</span><br><span class="line">    v20 = v5[6];</span><br><span class="line">    *v18 |= *v5 | ((v5[1] | (*((unsigned __int16 *)v5 + 1) &lt;&lt; 8)) &lt;&lt; 8);</span><br><span class="line">    v21 = v5[4] | ((v5[5] | ((v20 | v19) &lt;&lt; 8)) &lt;&lt; 8);</span><br><span class="line">    v22 = v5[10];</span><br><span class="line">    v18[1] |= v21;</span><br><span class="line">    v23 = v5[8] | ((v5[9] | ((v22 | (v5[11] &lt;&lt; 8)) &lt;&lt; 8)) &lt;&lt; 8);</span><br><span class="line">    v24 = v5[14];</span><br><span class="line">    v18[2] |= v23;</span><br><span class="line">    v25 = v5[13] | ((v24 | (v5[15] &lt;&lt; 8)) &lt;&lt; 8);</span><br><span class="line">    v26 = v5[12];</span><br><span class="line">    v27 = 0;</span><br><span class="line">    v18[3] |= v26 | (v25 &lt;&lt; 8);</span><br><span class="line">    v28 = (unsigned int)(v12 - 1);</span><br><span class="line">    v29 = v11[v28];</span><br><span class="line">    v30 = 0x34 / (unsigned int)v12 + 6;</span><br><span class="line">    v31 = (unsigned int)(v12 - 1);</span><br><span class="line">    v45 = v12 - 1;</span><br><span class="line">    v46 = (unsigned int)(v12 - 1);</span><br><span class="line">    <span class="keyword">if</span> ( (unsigned int)v28 &gt;= 1 &amp;&amp; 0x34 / (unsigned int)v12 != -6 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        v32 = v11 + 1;</span><br><span class="line">        v27 -= 1640531527;</span><br><span class="line">        v48 = v30 - 1;</span><br><span class="line">        v33 = 0i64;</span><br><span class="line">        v34 = v11;</span><br><span class="line">        v35 = (v27 &gt;&gt; 2) &amp; 3;</span><br><span class="line">        v36 = v31;</span><br><span class="line">        v37 = v28;</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">          v38 = *v32;</span><br><span class="line">          ++v32;</span><br><span class="line">          ++v34;</span><br><span class="line">          v39 = v35 ^ v33++ &amp; 3;</span><br><span class="line">          *(v34 - 1) += ((v27 ^ v38) + (v29 ^ v18[v39])) ^ ((16 * v29 ^ (v38 &gt;&gt; 3)) + ((v29 &gt;&gt; 5) ^ 4 * v38));</span><br><span class="line">          v29 = *(v34 - 1);</span><br><span class="line">          --v36;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> ( v36 );</span><br><span class="line">        v31 = v46;</span><br><span class="line">        LOBYTE(v28) = v45;</span><br><span class="line">        v30 = v48;</span><br><span class="line">        v11[v31] += ((v27 ^ *v11) + (v29 ^ v18[v35 ^ v37 &amp; 3])) ^ ((4 * *v11 ^ (v29 &gt;&gt; 5)) + ((*v11 &gt;&gt; 3) ^ 16 * v29));</span><br><span class="line">        v29 = v11[v46];</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( v48 );</span><br><span class="line">      v12 = v47;</span><br><span class="line">      v4 = v49;</span><br><span class="line">    &#125;</span><br><span class="line">    v40 = 4 * v12;</span><br><span class="line">    v41 = 4 * v12 + 1;</span><br><span class="line">    <span class="keyword">if</span> ( (unsigned __int64)(4 * v12) &gt;= 0xFFFFFFFFFFFFFFFFui64 )</span><br><span class="line">      v41 = -1i64;</span><br><span class="line">    v42 = malloc(v41);</span><br><span class="line">    v43 = v42;</span><br><span class="line">    <span class="keyword">if</span> ( v40 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        v42[v13] = v11[v13 &gt;&gt; 2] &gt;&gt; 8 * (v13 &amp; 3);</span><br><span class="line">        ++v13;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( v13 &lt; v40 );</span><br><span class="line">    &#125;</span><br><span class="line">    v42[v40] = 0;</span><br><span class="line">    *v4 = v40;</span><br><span class="line">    free(v11);</span><br><span class="line">    free(v18);</span><br><span class="line">    result = v43;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    free(v11);</span><br><span class="line">    result = 0i64;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>取输入的前4个字符作为xxtea加密的密钥之后进行xxtea加密，接着进行位置置换操作，然后又进行了以3个为一组的异或，由于没见过什么xxtea的算法(这里还是vct师傅咔嚓咔嚓告诉我的这个算法)于是学习了一下(在这个题结束的时候写了一下)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">v17 = Size;</span><br><span class="line">v18 = v16;</span><br><span class="line">v19 = sub_140001E5C(Size);</span><br><span class="line">v20 = 1;</span><br><span class="line">*v19 = v18[2];</span><br><span class="line">v21 = v19 + 1;</span><br><span class="line">v19[1] = *v18;</span><br><span class="line">v19[2] = v18[3];</span><br><span class="line">v19[3] = v18[1];</span><br><span class="line">v19[4] = v18[6];</span><br><span class="line">v19[5] = v18[4];</span><br><span class="line">v19[6] = v18[7];</span><br><span class="line">v19[7] = v18[5];</span><br><span class="line">v19[8] = v18[10];</span><br><span class="line">v19[9] = v18[8];</span><br><span class="line">v19[10] = v18[11];</span><br><span class="line">v19[11] = v18[9];</span><br><span class="line">v19[12] = v18[14];</span><br><span class="line">v19[13] = v18[12];</span><br><span class="line">v19[14] = v18[15];</span><br><span class="line">v19[15] = v18[13];</span><br><span class="line">v19[16] = v18[18];</span><br><span class="line">v19[17] = v18[16];</span><br><span class="line">v19[18] = v18[19];</span><br><span class="line">v19[19] = v18[17];</span><br><span class="line">v19[20] = v18[22];</span><br><span class="line">v19[21] = v18[20];</span><br><span class="line">v19[22] = v18[23];</span><br><span class="line"><span class="keyword">for</span> ( v19[23] = v18[21]; v20 &lt; v17; ++v21 )</span><br><span class="line">&#123;</span><br><span class="line">  v22 = 0i64;</span><br><span class="line">  <span class="keyword">if</span> ( v20 / 3 &gt; 0 )</span><br><span class="line">  &#123;</span><br><span class="line">    v23 = *v21;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      v23 ^= v19[v22++];</span><br><span class="line">      *v21 = v23;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( v22 &lt; v20 / 3 );</span><br><span class="line">  &#125;</span><br><span class="line">  ++v20;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们需要解出来在xxtea加密后的那一串数值<br><img src="/images/pasted-149.png" alt="upload successful"><br>00000060E7AFFB28  CE BC 40 6B 7C 3A 95 C0 EF 9B 20 20 91 F7 02 35<br>00000060E7AFFB38  23 18 02 C8 E7 56 56 FA </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include&lt;stdio.h&gt;</span></span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">	int count = 0;</span><br><span class="line">	int b[24];</span><br><span class="line">	int a[] = &#123; 0xCE, 0xBC, 0x40, 0x6B, 0x7C, 0x3A, 0x95, 0xC0, 0xEF, 0x9B, 0x20, 0x20, 0x91, 0xF7, 0x02, 0x35, 0x23, 0x18, 0x02, 0xC8, 0xE7, 0x56, 0x56, 0xFA &#125;;</span><br><span class="line">	<span class="keyword">for</span> (int i = 23; i &gt;= 3; i--)</span><br><span class="line">	&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> (int j = 6 - count; j &gt;= 0; j--)</span><br><span class="line">		&#123;</span><br><span class="line">			a[i] ^= a[j];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (i % 3 == 0)</span><br><span class="line">		&#123;</span><br><span class="line">			count++;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (int i = 0; i &lt; 24; i++)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"0x%x,"</span>, a[i]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">	b[2] = a[0];</span><br><span class="line">	b[0] = a[1];</span><br><span class="line">	b[3] = a[2];</span><br><span class="line">	b[1] = a[3];</span><br><span class="line">	b[6] = a[4];</span><br><span class="line">	b[4] = a[5];</span><br><span class="line">	b[7] = a[6];</span><br><span class="line">	b[5] = a[7];</span><br><span class="line">	b[10] = a[8];</span><br><span class="line">	b[8] = a[9];</span><br><span class="line">	b[11] = a[10];</span><br><span class="line">	b[9] = a[11];</span><br><span class="line">	b[14] = a[12];</span><br><span class="line">	b[12] = a[13];</span><br><span class="line">	b[15] = a[14];</span><br><span class="line">	b[13] = a[15];</span><br><span class="line">	b[18] = a[16];</span><br><span class="line">	b[16] = a[17];</span><br><span class="line">	b[19] = a[18];</span><br><span class="line">	b[17] = a[19];</span><br><span class="line">	b[22] = a[20];</span><br><span class="line">	b[20] = a[21];</span><br><span class="line">	b[23] = a[22];</span><br><span class="line">	b[21] = a[23];</span><br><span class="line">	<span class="keyword">for</span> (int i = 0; i &lt; 24; i++)</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">"0x%x,"</span>, b[i]);</span><br><span class="line">&#125;</span><br><span class="line">//0xbc,0xa5,0xce,0x40,0xf4,0xb2,0xb2,0xe7,0xa9,0x12,0x9d,0x12,0xae,0x10,0xc8,0x5b,0x3d,0xd7,0x6,0x1d,0xdc,0x70,0xf8,0xdc</span><br></pre></td></tr></table></figure>
<p>进行xxtea解密代码</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;stdint.h&gt;</span></span><br><span class="line"><span class="comment">#define DELTA 0x9e3779b9</span></span><br><span class="line"><span class="comment">#define MX (((z&gt;&gt;5^y&lt;&lt;2) + (y&gt;&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[(p&amp;3)^e] ^ z)))</span></span><br><span class="line"></span><br><span class="line">void btea(uint32_t* v, int n, uint32_t const key[4])</span><br><span class="line">&#123;</span><br><span class="line">	uint32_t y, z, sum;</span><br><span class="line">	unsigned p, rounds, e;</span><br><span class="line">	<span class="keyword">if</span> (n &gt; 1)            /* Coding Part */</span><br><span class="line">	&#123;</span><br><span class="line">		rounds = 6 + 52 / n;</span><br><span class="line">		sum = 0;</span><br><span class="line">		z = v[n - 1];</span><br><span class="line">		<span class="keyword">do</span></span><br><span class="line">		&#123;</span><br><span class="line">			sum += DELTA;</span><br><span class="line">			e = (sum &gt;&gt; 2) &amp; 3;</span><br><span class="line">			<span class="keyword">for</span> (p = 0; p &lt; n - 1; p++)</span><br><span class="line">			&#123;</span><br><span class="line">				y = v[p + 1];</span><br><span class="line">				z = v[p] += MX;</span><br><span class="line">			&#125;</span><br><span class="line">			y = v[0];</span><br><span class="line">			z = v[n - 1] += MX;</span><br><span class="line">		&#125; <span class="keyword">while</span> (--rounds);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (n &lt; -1)      /* Decoding Part */</span><br><span class="line">	&#123;</span><br><span class="line">		n = -n;</span><br><span class="line">		rounds = 6 + 52 / n;</span><br><span class="line">		sum = rounds * DELTA;</span><br><span class="line">		y = v[0];</span><br><span class="line">		<span class="keyword">do</span></span><br><span class="line">		&#123;</span><br><span class="line">			e = (sum &gt;&gt; 2) &amp; 3;</span><br><span class="line">			<span class="keyword">for</span> (p = n - 1; p &gt; 0; p--)</span><br><span class="line">			&#123;</span><br><span class="line">				z = v[p - 1];</span><br><span class="line">				y = v[p] -= MX;</span><br><span class="line">			&#125;</span><br><span class="line">			z = v[n - 1];</span><br><span class="line">			y = v[0] -= MX;</span><br><span class="line">			sum -= DELTA;</span><br><span class="line">		&#125; <span class="keyword">while</span> (--rounds);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">	uint32_t v[6] = &#123; (unsigned int)0x40cea5bc, (unsigned int)0xe7b2b2f4,(unsigned int)0x129d12a9,(unsigned int)0x5bc810ae,(unsigned int)0x1d06d73d,(unsigned int)0xdcf870dc &#125;;</span><br><span class="line">	uint32_t const k[4] = &#123; (unsigned int)0x67616c66, (unsigned int)0x0, (unsigned int)0X0, (unsigned int)0x0 &#125;;//flag密钥</span><br><span class="line">	int n = 6; //n的绝对值表示v的长度，取正表示加密，取负表示解密</span><br><span class="line">	// v为要加密的数据是两个32位无符号整数</span><br><span class="line">	// k为加密解密密钥，为4个32位无符号整数，即密钥长度为128位</span><br><span class="line">	//<span class="built_in">printf</span>(<span class="string">"加密前原始数据：%u %u\n"</span>, v[0], v[1]);</span><br><span class="line">	//btea(v, n, k);</span><br><span class="line">	//<span class="built_in">printf</span>(<span class="string">"加密后的数据：%u %u\n"</span>, v[0], v[1]);</span><br><span class="line">	btea(v, -n, k);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"解密后的数据：%x %x %x %x %x %x\n"</span>, v[0], v[1],v[2],v[3],v[4],v[5]);</span><br><span class="line">	<span class="built_in">return</span> 0;</span><br><span class="line">&#125;</span><br><span class="line">//67616c66 5858437b 646e615f 742b2b5f 7d6165 13</span><br><span class="line">//flag&#123;CXX_and_++tea&#125;</span><br></pre></td></tr></table></figure>

<h3 id="TEA系列（微型加密算法）"><a href="#TEA系列（微型加密算法）" class="headerlink" title="TEA系列（微型加密算法）"></a>TEA系列（微型加密算法）</h3><h4 id="特征"><a href="#特征" class="headerlink" title="特征"></a>特征</h4><p>含有Golden Ratio=0x9E3779B9</p>
<p>密钥长度为16byte（128位）</p>
<h4 id="TEA"><a href="#TEA" class="headerlink" title="TEA"></a>TEA</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdint.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//加密函数</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">encrypt</span> <span class="params">(<span class="keyword">uint32_t</span>* v, <span class="keyword">uint32_t</span>* k)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">uint32_t</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], sum=<span class="number">0</span>, i;           <span class="comment">/* set up */</span></span><br><span class="line">    <span class="keyword">uint32_t</span> delta=<span class="number">0x9e3779b9</span>;                     <span class="comment">/* a key schedule constant */</span></span><br><span class="line">    <span class="keyword">uint32_t</span> k0=k[<span class="number">0</span>], k1=k[<span class="number">1</span>], k2=k[<span class="number">2</span>], k3=k[<span class="number">3</span>];   <span class="comment">/* cache key */</span></span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;                       <span class="comment">/* basic cycle start */</span></span><br><span class="line">        sum += delta;</span><br><span class="line">        v0 += ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);</span><br><span class="line">        v1 += ((v0&lt;&lt;<span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k3);</span><br><span class="line">    &#125;                                              <span class="comment">/* end cycle */</span></span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//解密函数</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">decrypt</span> <span class="params">(<span class="keyword">uint32_t</span>* v, <span class="keyword">uint32_t</span>* k)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">uint32_t</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], sum=<span class="number">0xC6EF3720</span>, i;  <span class="comment">/* set up */</span></span><br><span class="line">    <span class="keyword">uint32_t</span> delta=<span class="number">0x9e3779b9</span>;                     <span class="comment">/* a key schedule constant */</span></span><br><span class="line">    <span class="keyword">uint32_t</span> k0=k[<span class="number">0</span>], k1=k[<span class="number">1</span>], k2=k[<span class="number">2</span>], k3=k[<span class="number">3</span>];   <span class="comment">/* cache key */</span></span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="number">32</span>; i++) &#123;                         <span class="comment">/* basic cycle start */</span></span><br><span class="line">        v1 -= ((v0&lt;&lt;<span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k3);</span><br><span class="line">        v0 -= ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);</span><br><span class="line">        sum -= delta;</span><br><span class="line">    &#125;                                              <span class="comment">/* end cycle */</span></span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">uint32_t</span> v[<span class="number">2</span>]=&#123;<span class="number">1</span>,<span class="number">2</span>&#125;,k[<span class="number">4</span>]=&#123;<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>&#125;;</span><br><span class="line">    <span class="comment">// v为要加密的数据是两个32位无符号整数</span></span><br><span class="line">    <span class="comment">// k为加密解密密钥，为4个32位无符号整数，即密钥长度为128位</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"加密前原始数据：%u %u\n"</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    encrypt(v, k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"加密后的数据：%u %u\n"</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    decrypt(v, k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"解密后的数据：%u %u\n"</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="XTEA"><a href="#XTEA" class="headerlink" title="XTEA"></a>XTEA</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdint.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="comment">/* take 64 bits of data in v[0] and v[1] and 128 bits of key[0] - key[3] */</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">encipher</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> num_rounds, <span class="keyword">uint32_t</span> v[<span class="number">2</span>], <span class="keyword">uint32_t</span> <span class="keyword">const</span> key[<span class="number">4</span>])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">uint32_t</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], sum=<span class="number">0</span>, delta=<span class="number">0x9E3779B9</span>;</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; num_rounds; i++) &#123;</span><br><span class="line">        v0 += (((v1 &lt;&lt; <span class="number">4</span>) ^ (v1 &gt;&gt; <span class="number">5</span>)) + v1) ^ (sum + key[sum &amp; <span class="number">3</span>]);</span><br><span class="line">        sum += delta;</span><br><span class="line">        v1 += (((v0 &lt;&lt; <span class="number">4</span>) ^ (v0 &gt;&gt; <span class="number">5</span>)) + v0) ^ (sum + key[(sum&gt;&gt;<span class="number">11</span>) &amp; <span class="number">3</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">decipher</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> num_rounds, <span class="keyword">uint32_t</span> v[<span class="number">2</span>], <span class="keyword">uint32_t</span> <span class="keyword">const</span> key[<span class="number">4</span>])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">uint32_t</span> v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], delta=<span class="number">0x9E3779B9</span>, sum=delta*num_rounds;</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i &lt; num_rounds; i++) &#123;</span><br><span class="line">        v1 -= (((v0 &lt;&lt; <span class="number">4</span>) ^ (v0 &gt;&gt; <span class="number">5</span>)) + v0) ^ (sum + key[(sum&gt;&gt;<span class="number">11</span>) &amp; <span class="number">3</span>]);</span><br><span class="line">        sum -= delta;</span><br><span class="line">        v0 -= (((v1 &lt;&lt; <span class="number">4</span>) ^ (v1 &gt;&gt; <span class="number">5</span>)) + v1) ^ (sum + key[sum &amp; <span class="number">3</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">uint32_t</span> v[<span class="number">2</span>]=&#123;<span class="number">1</span>,<span class="number">2</span>&#125;;</span><br><span class="line">    <span class="keyword">uint32_t</span> <span class="keyword">const</span> k[<span class="number">4</span>]=&#123;<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>&#125;;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> r=<span class="number">32</span>;<span class="comment">//num_rounds建议取值为32</span></span><br><span class="line">    <span class="comment">// v为要加密的数据是两个32位无符号整数</span></span><br><span class="line">    <span class="comment">// k为加密解密密钥，为4个32位无符号整数，即密钥长度为128位</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"加密前原始数据：%u %u\n"</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    encipher(r, v, k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"加密后的数据：%u %u\n"</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    decipher(r, v, k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"解密后的数据：%u %u\n"</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="XXTEA"><a href="#XXTEA" class="headerlink" title="XXTEA"></a>XXTEA</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DELTA 0x9e3779b9</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MX (((z&gt;&gt;5^y<span class="meta-string">&lt;&lt;2) + (y&gt;&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[(p&amp;3)^e] ^ z)))</span></span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">btea</span><span class="params">(<span class="keyword">uint32_t</span> *v, <span class="keyword">int</span> n, <span class="keyword">uint32_t</span> <span class="keyword">const</span> key[<span class="number">4</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">uint32_t</span> y, z, sum;</span><br><span class="line">    <span class="keyword">unsigned</span> p, rounds, e;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>)            <span class="comment">/* Coding Part */</span></span><br><span class="line">    &#123;</span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span>/n;</span><br><span class="line">        sum = <span class="number">0</span>;</span><br><span class="line">        z = v[n<span class="number">-1</span>];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            sum += DELTA;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p=<span class="number">0</span>; p&lt;n<span class="number">-1</span>; p++)</span><br><span class="line">            &#123;</span><br><span class="line">                y = v[p+<span class="number">1</span>];</span><br><span class="line">                z = v[p] += MX;</span><br><span class="line">            &#125;</span><br><span class="line">            y = v[<span class="number">0</span>];</span><br><span class="line">            z = v[n<span class="number">-1</span>] += MX;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (n &lt; <span class="number">-1</span>)      <span class="comment">/* Decoding Part */</span></span><br><span class="line">    &#123;</span><br><span class="line">        n = -n;</span><br><span class="line">        rounds = <span class="number">6</span> + <span class="number">52</span>/n;</span><br><span class="line">        sum = rounds*DELTA;</span><br><span class="line">        y = v[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">do</span></span><br><span class="line">        &#123;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p=n<span class="number">-1</span>; p&gt;<span class="number">0</span>; p--)</span><br><span class="line">            &#123;</span><br><span class="line">                z = v[p<span class="number">-1</span>];</span><br><span class="line">                y = v[p] -= MX;</span><br><span class="line">            &#125;</span><br><span class="line">            z = v[n<span class="number">-1</span>];</span><br><span class="line">            y = v[<span class="number">0</span>] -= MX;</span><br><span class="line">            sum -= DELTA;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">uint32_t</span> v[<span class="number">2</span>]= &#123;<span class="number">1</span>,<span class="number">2</span>&#125;;</span><br><span class="line">    <span class="keyword">uint32_t</span> <span class="keyword">const</span> k[<span class="number">4</span>]= &#123;<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> n= <span class="number">2</span>; <span class="comment">//n的绝对值表示v的长度，取正表示加密，取负表示解密</span></span><br><span class="line">    <span class="comment">// v为要加密的数据是两个32位无符号整数</span></span><br><span class="line">    <span class="comment">// k为加密解密密钥，为4个32位无符号整数，即密钥长度为128位</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"加密前原始数据：%u %u\n"</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    btea(v, n, k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"加密后的数据：%u %u\n"</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    btea(v, -n, k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"解密后的数据：%u %u\n"</span>,v[<span class="number">0</span>],v[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="TEA-in-CTF"><a href="#TEA-in-CTF" class="headerlink" title="TEA in CTF"></a>TEA in CTF</h4><p>例题：Tea相关</p>
<p>认清三种TEA加密</p>
<p>解密代码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _CRT_SECURE_NO_WARNINGS</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DELTA 0x9e3779b9</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MX (((z&gt;&gt;5^y<span class="meta-string">&lt;&lt;2) + (y&gt;&gt;3^z&lt;&lt;4)) ^ ((sum^y) + (key[(p&amp;3)^e] ^ z)))</span></span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">btea</span><span class="params">(<span class="keyword">uint32_t</span> *v, <span class="keyword">int</span> n, <span class="keyword">uint32_t</span> <span class="keyword">const</span> key[<span class="number">4</span>])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">uint32_t</span> y, z, sum;</span><br><span class="line">	<span class="keyword">unsigned</span> p, rounds, e;</span><br><span class="line">	<span class="keyword">if</span> (n &gt; <span class="number">1</span>)            <span class="comment">/* Coding Part */</span></span><br><span class="line">	&#123;</span><br><span class="line">		rounds = <span class="number">6</span> + <span class="number">52</span> / n;</span><br><span class="line">		sum = <span class="number">0</span>;</span><br><span class="line">		z = v[n - <span class="number">1</span>];</span><br><span class="line">		<span class="keyword">do</span></span><br><span class="line">		&#123;</span><br><span class="line">			sum += DELTA;</span><br><span class="line">			e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">			<span class="keyword">for</span> (p = <span class="number">0</span>; p&lt;n - <span class="number">1</span>; p++)</span><br><span class="line">			&#123;</span><br><span class="line">				y = v[p + <span class="number">1</span>];</span><br><span class="line">				z = v[p] += MX;</span><br><span class="line">			&#125;</span><br><span class="line">			y = v[<span class="number">0</span>];</span><br><span class="line">			z = v[n - <span class="number">1</span>] += MX;</span><br><span class="line">		&#125; <span class="keyword">while</span> (--rounds);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (n &lt; <span class="number">-1</span>)      <span class="comment">/* Decoding Part */</span></span><br><span class="line">	&#123;</span><br><span class="line">		n = -n;</span><br><span class="line">		rounds = <span class="number">6</span> + <span class="number">52</span> / n;</span><br><span class="line">		sum = rounds*DELTA;</span><br><span class="line">		y = v[<span class="number">0</span>];</span><br><span class="line">		<span class="keyword">do</span></span><br><span class="line">		&#123;</span><br><span class="line">			e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">			<span class="keyword">for</span> (p = n - <span class="number">1</span>; p&gt;<span class="number">0</span>; p--)</span><br><span class="line">			&#123;</span><br><span class="line">				z = v[p - <span class="number">1</span>];</span><br><span class="line">				y = v[p] -= MX;</span><br><span class="line">			&#125;</span><br><span class="line">			z = v[n - <span class="number">1</span>];</span><br><span class="line">			y = v[<span class="number">0</span>] -= MX;</span><br><span class="line">			sum -= DELTA;</span><br><span class="line">		&#125; <span class="keyword">while</span> (--rounds);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">decipher</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> num_rounds, <span class="keyword">uint32_t</span> v[<span class="number">2</span>], <span class="keyword">uint32_t</span> <span class="keyword">const</span> key[<span class="number">4</span>])</span> </span>&#123;</span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">int</span> i;</span><br><span class="line">	<span class="keyword">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>], delta = <span class="number">0x9E3779B9</span>, sum = delta*num_rounds;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; num_rounds; i++) &#123;</span><br><span class="line">		v1 -= (((v0 &lt;&lt; <span class="number">4</span>) ^ (v0 &gt;&gt; <span class="number">5</span>)) + v0) ^ (sum + key[(sum &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>]);</span><br><span class="line">		sum -= delta;</span><br><span class="line">		v0 -= (((v1 &lt;&lt; <span class="number">4</span>) ^ (v1 &gt;&gt; <span class="number">5</span>)) + v1) ^ (sum + key[sum &amp; <span class="number">3</span>]);</span><br><span class="line">	&#125;</span><br><span class="line">	v[<span class="number">0</span>] = v0; v[<span class="number">1</span>] = v1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">decrypt</span><span class="params">(<span class="keyword">uint32_t</span>* v, <span class="keyword">uint32_t</span>* k)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>], sum = <span class="number">0xC6EF3720</span>, i;  <span class="comment">/* set up */</span></span><br><span class="line">	<span class="keyword">uint32_t</span> delta = <span class="number">0x9e3779b9</span>;                     <span class="comment">/* a key schedule constant */</span></span><br><span class="line">	<span class="keyword">uint32_t</span> k0 = k[<span class="number">0</span>], k1 = k[<span class="number">1</span>], k2 = k[<span class="number">2</span>], k3 = k[<span class="number">3</span>];   <span class="comment">/* cache key */</span></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i&lt;<span class="number">32</span>; i++) &#123;                         <span class="comment">/* basic cycle start */</span></span><br><span class="line">		v1 -= ((v0 &lt;&lt; <span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0 &gt;&gt; <span class="number">5</span>) + k3);</span><br><span class="line">		v0 -= ((v1 &lt;&lt; <span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1 &gt;&gt; <span class="number">5</span>) + k1);</span><br><span class="line">		sum -= delta;</span><br><span class="line">	&#125;                                              <span class="comment">/* end cycle */</span></span><br><span class="line">	v[<span class="number">0</span>] = v0; v[<span class="number">1</span>] = v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">int</span> v[<span class="number">2</span>] = &#123; <span class="number">0xE96DCB1C</span>,<span class="number">0x5434E1AC</span> &#125;;</span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">int</span>  key[<span class="number">4</span>] = &#123; <span class="number">0x656d6f63</span>, <span class="number">0x7469775f</span>, <span class="number">0x656d5f68</span>, <span class="number">0x646E655f</span> &#125;;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"解密后的数据：%x %x\n"</span>, v[<span class="number">0</span>], v[<span class="number">1</span>]);</span><br><span class="line">	btea(v, <span class="number">-2</span>, key);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"解密后的数据：%x %x\n"</span>, v[<span class="number">0</span>], v[<span class="number">1</span>]);</span><br><span class="line">	decipher(<span class="number">32</span>, v, key);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"解密后的数据：%x %x\n"</span>, v[<span class="number">0</span>], v[<span class="number">1</span>]);</span><br><span class="line">	decrypt(v, key);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"解密后的数据：%x %x\n"</span>, v[<span class="number">0</span>], v[<span class="number">1</span>]);</span><br><span class="line">	system(<span class="string">"pause"</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/01/03/ZUC%E7%AE%97%E6%B3%95/" rel="next" title="ZUC算法">
                <i class="fa fa-chevron-left"></i> ZUC算法
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/01/10/reverse%E4%B9%8B%E5%AF%86%E7%A0%81%E7%AE%97%E6%B3%95/" rel="prev" title="RE crypto">
                RE crypto <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/header.jpg"
                alt="L0x1c" />
            
              <p class="site-author-name" itemprop="name">L0x1c</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">1</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/L0x1c" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://twitter.com/L0x1c" target="_blank" title="Twitter">
                      
                        <i class="fa fa-fw fa-twitter"></i>Twitter</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://xi4or0uji.github.io/" title="Xi4or0uji" target="_blank">Xi4or0uji</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#easy-re"><span class="nav-number">1.</span> <span class="nav-text">easy re</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#xx"><span class="nav-number">2.</span> <span class="nav-text">xx</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#TEA系列（微型加密算法）"><span class="nav-number">2.1.</span> <span class="nav-text">TEA系列（微型加密算法）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#特征"><span class="nav-number">2.1.1.</span> <span class="nav-text">特征</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#TEA"><span class="nav-number">2.1.2.</span> <span class="nav-text">TEA</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#XTEA"><span class="nav-number">2.1.3.</span> <span class="nav-text">XTEA</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#XXTEA"><span class="nav-number">2.1.4.</span> <span class="nav-text">XXTEA</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#TEA-in-CTF"><span class="nav-number">2.1.5.</span> <span class="nav-text">TEA in CTF</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
    </script>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">L0x1c</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('3');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

</body>
</html>
